# –ö–∞–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–æ—Ç–Ω–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ PostgreSQL –∏ –Ω–µ —Å–æ–π—Ç–∏ —Å —É–º–∞

## –í–≤–µ–¥–µ–Ω–∏–µ –∏ —Ü–µ–ª–∏ —Å—Ç–∞—Ç—å–∏ (–¥–ª—è –∫–æ–≥–æ –æ–Ω–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞ –∏ —á—Ç–æ –¥–∞—Å—Ç —á–∏—Ç–∞—Ç–µ–ª—é)
–ß–∏—Ç–∞—Ç—å 16 –º–∏–Ω—É—Ç.

–ï—Å–ª–∏ –≤—ã –∏–Ω–∂–µ–Ω–µ—Ä (?) –≤ –∫—Ä—É–ø–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –≤–∞—à–∞ –æ—Ä–≥–∞–Ω–∏—â–∞—Ü–∏—è –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–≤–æ–∏ —É—Å–ª—É–≥–∏ –≤ –≤–∏–¥–µ SaaS —Ä–µ—à–µ–Ω–∏–π), —Ç–æ –≤–∞–º —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –Ω–∞–¥–æ –±—É–¥–µ—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –≤–∞—à–∏—Ö PostgreSQL. –û—á–µ–Ω—å —á–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç —Ç–∞–∫ —á—Ç–æ –Ω–∞ Postgre SQL –∑–∞–≤—è–∑–∞–Ω –≤–∞–∂–Ω—ã–π —Å —Ç.–∑. —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –∫—Ä–∞–π–Ω–µ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –∏–º–µ—Ç—å –º–æ–Ω–∏—Ç—Ä–∏–Ω–≥, –Ω–æ –∏ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –∏–¥–µ—Ç –Ω–µ —Ç–∞–∫ (–∏–ª–∏ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞—Ä–∞–Ω–µ–µ, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫ –≤ —Å–∞–º–æ–º –±–ª–∏–∂–∞–π—à–µ–º –±—É–¥—É—â–µ–º).
–í —Ä–∞–º–∫–∞—Ö —Å—Ç–∞—Ç—å–∏ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ —ç—Ç–æ –º–æ–∂–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å:
- –í—Å–µ —Å–∞–º–æ–º—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—Ç–∞–≤—à–µ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º —Å—Ç–µ–∫–∞ Prometheus + Grafana (–Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –≤ –ø–æ—Å–ª–µ–¥—É—é—â–µ–º —Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –≤–∞—à–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤);
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å opensorce —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ PostgreSQL;
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è;
–ü–æ –∫–∞–∂–¥–æ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É –ø–æ–π–º–µ–º –≤—Å–µ –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∏–º–µ–Ω–Ω–æ –≤–∞—à –ø—É—Ç—å.

## –í—Å–µ —Å–∞–º–æ–º—É —Å –ø–æ–º–æ—â—å—é Prometheus + Grafana
–ù–∞ —Å–≤—è–∑–∫–µ Prometheus —Å Grafana —Å—Ç—Ä–æ—è—Ç —Å–≤–æ–∏ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–∞–º–ø–∞–Ω–∏–π. –ó–¥–µ—Å—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤ —Ç–æ–º, —á—Ç–æ –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –≤ Prometheus –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–¥—Ö–æ–¥—è—â—É—é –ø–æ–¥ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ª—é–±—ã–µ –Ω—É–∂–¥—ã. –£ –≤–∞—Å –Ω–µ –±—É–¥–µ—Ç –∑–æ–æ–ø–∞—Ä–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –≤—Å–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ. –ù–∞—É—á–∏–≤—à–∏—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–±—Å–æ–ª—é—Ç–Ω–æ –ª—é–±—ã—Ö —Å–∏—Å—Ç–µ–º –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.

![–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PosgreSQL —Å Prometheus –∏ Grafana](/images/prometheus.drawio.png)

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:
### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å postgresql_exporter –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ PostgreSQL.
https://github.com/prometheus-community/postgres_exporter/  
–ü–æ —Å—É—Ç–∏ —ç—Ç–æ –∞–≥–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ PostgreSQL –∏ –æ—Ç–¥–∞–≤–∞—Ç—å –∏—Ö –≤ Prometheus –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–º—É endpoint (–¥–∞–ª–µ–µ Prometheus –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –∫–∞–∂–¥—ã–µ n —Å–µ–∫—É–Ω–¥ –∏ —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤ —Å–≤–æ—é time series –ë–î).

---
#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã postgres_exporter (—Ä–∞–≤–Ω–æ –∫–∞–∫ –∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ –¥–ª—è Grafana)
##### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PG:
postgres_exporter –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ PostgreSQL —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–æ–±—ã—á–Ω–æ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 5432) –∏ –≥–æ–Ω—è–µ—Ç –∫ –Ω–µ–º—É —Å—Ç–∞–Ω–¥–∞–Ω—Ç–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏.
–ü–æ –ø—Ä–∞–≤–∞–º –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ PG –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–ª–µ–Ω—Å—Ç–≤–æ –≤ —Ä–æ–ª–∏ pg_monitor).
##### –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫:
postgres_exporter –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å—ã –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º PostgreSQL (–Ω–∞–ø—Ä–∏–º–µ—Ä, pg_stat_database, pg_stat_activity, pg_stat_replication, pg_stat_bgwriter, –∏ —Ç.–¥.).
–ú–µ—Ç—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç Prometheus.  
–ó–¥–µ—Å—å –≤–∞–∂–Ω–æ –∏–º–µ—Ç—å –≤ –≤–∏–¥—É, —á—Ç–æ –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤ PG —Ä—è–¥ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, —Ç–æ –Ω–∞–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –±—É–¥–µ—Ç –≤–µ—Å—å–º–∞ —Å–∫—É–¥–Ω—ã–º. –î–ª—è —Å–±–æ—Ä–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ —Ä–∞–∑–¥—É—Ç–∏—é —Ç–∞–±–ª–∏—Ü, —Ä–∞–±–æ—Ç–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –ø—Ä. –Ω–∞–¥–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –µ—â–µ —Ä—è–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å postgres_exporter. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–ª–µ–∑–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
- pg_stat_statements —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏;
- pg_buffercache –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±—É—Ñ–µ—Ä–æ–≤ PostgreSQL;  

–ù–∞–¥–æ –∏–º–µ—Ç—å –≤ –≤–∏–¥—É, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –±—É–¥–µ—Ç, –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö, –æ—Ç–∂–∏—Ä–∞—Ç—å —É –≤–∞—Å —Ä–µ—Å—É—Ä—Å—ã —Å–∞–º–æ–≥–æ PostgreSQL, –≤–∞–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ —ç—Ç–∏–º.
–ü–ª—é—Å –ø—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç—Ç–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –Ω–µ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞—á–Ω–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å —Å–∞–º postgres_exporter. –ù–∞–¥–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ –º–æ–∂–µ—Ç –æ—Ç–Ω—è—Ç—å —É –≤–∞—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.

##### –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫:
–°–µ—Ä–≤–∏—Å postgres_exporter –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTTP-endpoint (/metrics), —Å –∫–æ—Ç–æ—Ä–æ–≥–æ Prometheus —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (scrape - —Ç.–Ω. —Å–∫—Ä–∞–ø–ø–∏–Ω–≥ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã —á–µ—Ä–µ–∑ n —Å–µ–∫—É–Ω–¥).

> –ü–æ—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º —Ä–∞–±–æ—Ç–∞—é—Ç –≤—Å–µ –¥—Ä—É–≥–∏–µ –≤–∏–¥—ã —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ –¥–ª—è prometheus. –£ Prometheus –µ—Å—Ç—å –º–∞—Å—Å–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ mysql_exporter, mongodb_exporter, redis_exporter –∏ –ø—Ä.

---  


> **–î–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Å–∞–º–æ–≥–æ —Ö–æ—Å—Ç–∞ –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å node_exporter, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º**

–£—Å—Ç–∞–Ω–æ–≤–∏–≤ postgres_exporter –Ω–∞–¥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª—å–∑–∞–∫–∞, –ø–æ–¥ –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```
CREATE USER postgres_exporter WITH PASSWORD '****';
ALTER USER postgres_exporter SET SEARCH_PATH TO postgres_exporter,pg_catalog;

-- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
GRANT CONNECT ON DATABASE postgres TO postgres_exporter;
GRANT pg_monitor TO postgres_exporter;

```
–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—É—Å–∫ postgres_exporter –≤ –≤–∏–¥–µ —Å–µ—Ä–≤–∏—Å–∞ (systemd)

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—É—Å–∫ postgres_exporter –≤ –≤–∏–¥–µ —Å–µ—Ä–≤–∏—Å–∞ (systemd):
–°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª–∏–∫ /etc/systemd/system/postgres_exporter.service:
```
[Unit]
Description=Prometheus PostgreSQL Exporter
Wants=network-online.target
After=network-online.target

[Service]
User=postgres
Group=postgres
Type=simple
ExecStart=/usr/local/bin/postgres_exporter \
  --web.listen-address=0.0.0.0:9187 \
  --web.telemetry-path=/metrics \
  --log.level=info \
  --extend.query-path=/etc/postgres_exporter/queries.yaml \
  DATA_SOURCE_NAME="postgresql://postgres_exporter:exporter_password@localhost:5432/postgres?sslmode=disable"

Restart=always

[Install]
WantedBy=multi-user.target

```
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É:

```
systemctl daemon-reload
systemctl start postgres_exporter
systemctl enable postgres_exporter
```
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–∏–∫ –ø–æ –∞–¥—Ä–µ—Å—É:
http://<IP_postgres_exporter>:9187/metrics

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Prometheus:
–î–∞–ª–µ–µ –Ω–∞–º –Ω–∞–¥–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å [Prometheus](https://prometheus.io/download/) –∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞—à endpoint exporter'–∞ –≤ –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥ /etc/prometheus/prometheus.yml
```
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'postgres'
    static_configs:
      - targets: ['IP_postgres_exporter:9187']

```

–ó–∞–ø—É—Å–∫–∞–µ–º Prometheus –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É:
```
systemctl restart prometheus
systemctl enable prometheus
```

–ü—Ä–∏–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –º–æ–∂–Ω–æ –∑–∞–π–¥—è –ø–æ –∞–¥—Ä–µ—Å—É http://<IP_prometheus>:9090

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Prometheus –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö:
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Grafana –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–∞—à Prometheus –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —ç—Ç–æ–≥–æ:
1. –ó–∞—Ö–æ–¥–∏–º –≤ Grafana: http://<IP_grafana>:3000
2. –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–∞–∑–¥–µ–ª: 
```
Configuration ‚Üí Data sources ‚Üí Add data source ‚Üí Prometheus
```
3. –£–∫–∞–∑—ã–≤–∞–µ–º URL –Ω–∞—à–µ–≥–æ Prometheus
```
http://<IP_prometheus>:9090
```

### 5. –î–æ–±–∞–≤–∏–º –≥–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã PostgreSQL –≤ Grafana:
–õ—É—á—à–µ –≤–∑—è—Ç—å –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã:
- Postgres Overview <https://grafana.com/grafana/dashboards/455-postgres-overview/>

![–î–∞—à–±–æ—Ä–¥ Postgres Overview](/images/pg_overview.png)

- PostgreSQL Database <https://grafana.com/grafana/dashboards/9628-postgresql-database/>

![–î–∞—à–±–æ—Ä–¥ PostgreSQL Database](/images/pg_database.png)

–í—ã–±–∏—Ä–∞–µ–º –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–π—Å—è –∏ –≤ Grafana –≤—ã–±–∏—Ä–∞–µ–º:

```
Dashboards ‚Üí Import ‚Üí –≤—Å—Ç–∞–≤—å ID (9628 –∏–ª–∏ 455) ‚Üí –≤—ã–±–µ—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ Prometheus.
```

### –ú–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã —Ç–∞–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
#### –ü–ª—é—Å—ã
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –ª—é–±—ã—Ö –≤–∞—à–∏—Ö —Å–∏—Å—Ç–µ–º. –ú–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ –≤–∞—à–∏ —Å–∏—Å—Ç–µ–º—ã –≤ –µ–¥–∏–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ;
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –≥–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏;
- –ü–æ–ª–Ω–∞—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç—å;
- –ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç;
#### –ú–∏–Ω—É—Å—ã
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏;
- –ù–µ—Ç –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ç–æ–ª—å–∫–æ –Ω–∞ "—Å–µ–π—á–∞—Å";
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–∞–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π);
- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ "—Ç—è–∂–µ–ª—ã–º" –∑–∞–ø—Ä–æ—Å–∞–º. –ù–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∞ —Ç–∞–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤;

–í —Ü–µ–ª–æ–º —Ç–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–∞–º–æ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–ª–∏ –¥–ª—è —Ç–æ–≥–æ, –∫—Ç–æ —Å–∞–º –æ—Ç–ª–∏—á–Ω—ã–π DBA –∏ –∑–Ω–∞–µ—Ç –∫–∞–∫ –∏ —á—Ç–æ –µ–º—É –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏, —á—Ç–æ–±—ã —Å–æ–±–∏—Ä–∞—Ç—å —Ç–æ —á—Ç–æ –Ω—É–∂–Ω–æ.

*–¢–∞–∫-–∂–µ –Ω–∞–¥–æ –ø–æ–Ω–∏–º–∞—Ç—å –∫–∞–∫–∏–µ –≤–∞–º –Ω—É–∂–Ω—ã —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è (—Ç.–Ω. Alerting).*

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏—Ö –º–æ–∂–Ω–æ –∫–∞–∫ –≤ Grafana ("Alert" ‚Üí "Create alert rule" –Ω–∞ –ø–∞–Ω–µ–ª–∏) –∏ —É–∫–∞–∑–∞–≤ –∑–∞–ø—Ä–æ—Å –º–µ—Ç—Ä–∏–∫–∏:

```
avg(pg_stat_database_blks_hit / (pg_stat_database_blks_hit + pg_stat_database_blks_read))
```

–î–∞–ª–µ–µ –∑–∞–¥–∞—Ç—å –ø–æ—Ä–æ–≥, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∫–æ–ª—å–∫–æ –¥–µ—Ä–∂–∏—Ç—Å—è —É—Å–ª–æ–≤–∏–µ, —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–æ email, Slack –∏ –ø—Ä.

–¢–∞–∫-–∂–µ –∞–ª–µ—Ä—Ç–∏–Ω–≥ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤ Prometheus. –í–∏–∑—É–∞–ª—å–Ω–æ —Ç–∞–∫ —Å–¥–µ–ª–∞—Ç—å –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è. –ü—Ä–∏–¥–µ—Ç—Å—è –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å –≤—Å–µ –∞–ª–µ—Ä—Ç—ã –≤ yaml —Ñ–∞–π–ª–∏–∫–µ –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –Ω–µ–≥–æ –≤ prometheus.yml

## –ì–æ—Ç–æ–≤—ã–µ opensource —Ä–µ—à–µ–Ω–∏—è
–ö—Ç–æ –Ω–µ –≥–æ—Ç–æ–≤ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Å–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –ø–æ–ª—É—á–∏–≤ –Ω–∞ –≤—ã—Ö–æ–¥–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∫—É–¥–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –º–æ–≥—É—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å opensource —Ä–µ—à–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–º–µ–Ω–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ PostgreSQL. –î–∞–ª–µ–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–≤–∞ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–∑ –Ω–∏—Ö. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö, —Ä–∞–∑–≤–∏–≤–∞—é—â–∏—Ö—Å—è –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –Ω–µ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ.

### Percona Monitoring and Management (PMM)

https://www.percona.com/software/database-tools/percona-monitoring-and-management 

–î–æ–≤–æ–ª—å–Ω–æ –º–æ—â–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ PostgreSQL (+ –µ—â–µ MySQL –∏ MongoDB) —Å –±–∞–∑–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –≥–æ—Ç–æ–≤—ã–º–∏ –¥–∞—à–±–æ—Ä–¥–∞–º–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è production-—Å—Ä–µ–¥ —Å –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å—é –≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ.

![Percona](/images/percona.png)

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –∫–ª–∏–µ–Ω—Ç‚Äë—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å

 - PMM Client (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–µ—Ä–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö):
   - –í–∫–ª—é—á–∞–µ—Ç pmm-agent (—É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏);
   - –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–µ —Å–∞–º—ã–µ postgres_exporter –∏ node_exporter) –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫;
   - vmagent (–æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö);

 - PMM Server (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞):
   - –•—Ä–∞–Ω–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ VictoriaMetrics;
   - –•—Ä–∞–Ω–∏—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ ClickHouse;
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥—ã —á–µ—Ä–µ–∑ Grafana —Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º–∏ Percona —à–∞–±–ª–æ–Ω–∞–º–∏ –¥–ª—è –Ω–µ–µ (–∫–∞–∫ –≤–µ–± –º–æ—Ä–¥—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Garafana, –¥–∞);
   - –í–∫–ª—é—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ Query Analytics (QAN) –∏ Percona Advisors (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏);

![PMM Architecture](/images/pmm.png)

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

|||
|---|---|
| –®–∞–±–ª–æ–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã Grafana –¥–ª—è PostgreSQL | –í–∫–ª—é—á–∞—é—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: CPU, –ø–∞–º—è—Ç—å, I/O, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, tuples, –∏–Ω–¥–µ–∫—Å—ã, —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫, –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –ø—Ä–æ—á–µ–µ ([–ø–æ–¥—Ä–æ–±–Ω–µ–µ](https://www.percona.com/software/database-tools/percona-monitoring-and-management/postgresql-monitoring)). |
| –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤      | –ê–Ω–∞–ª–∏–∑ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤: –º–µ–¥–ª–µ–Ω–Ω—ã–µ, —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏–µ, —Å –¥–µ—Ç–∞–ª—è–º–∏ EXPLAIN –∏ –∏—Å—Ç–æ—Ä–∏–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ([–ø–æ–¥—Ä–æ–±–Ω–µ–µ](https://www.percona.com/blog/inspecting-mysql-servers-part-5-percona-monitoring-and-management/)). |
| –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (Annotations)    | –£–¥–æ–±–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ä—É—á–Ω—É—é –æ—Ç–º–µ—á–∞—Ç—å —Å–æ–±—ã—Ç–∏—è (–¥–µ–ø–ª–æ–π, —Å–±–æ–π –∏ —Ç.–ø.) –ø—Ä—è–º–æ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏—á–∏–Ω –ø—Ä–æ–±–ª–µ–º ([–ø–æ–¥—Ä–æ–±–Ω–µ–µ](https://www.percona.com/software/database-tools/percona-monitoring-and-management/postgresql-monitoring?utm_source=chatgpt.com)). |
| Percona Advisors          | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ([–ø–æ–¥—Ä–æ–±–Ω–µ–µ](https://www.percona.com/software/database-tools/percona-monitoring-and-management/postgresql-monitoring)). |
| Alerting & —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ      | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ç–∫–∞–ø–æ–≤ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è ([–ø–æ–¥—Ä–æ–±–Ω–µ–µ](https://www.percona.com/software/database-tools/percona-monitoring-and-management)). |

#### –ú–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã PMM
##### –ü–ª—é—Å—ã
- "–ò–∑ –∫–æ—Ä–æ–±–∫–∏" –≥–æ—Ç–æ–≤—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è PostgreSQL;
- –í–∫–ª—é—á–∞–µ—Ç Query Analytics –∏ Advisors (—ç—Ç–æ–≥–æ –Ω–µ—Ç –≤ —Ç–∏–ø–æ–≤–æ–π —Å–≤—è–∑–∫–µ Grafana + Prometheus);
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞;
- –ì–∏–±–∫–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ Docker, Helm –∏ –ø—Ä.
##### –ú–∏–Ω—É—Å—ã
- –ë–æ–ª—å—à–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Å–ª–æ–∂–Ω–µ–µ –º–µ–Ω—Ç–µ–π–Ω–∏—Ç—å –≤—Å–µ —ç—Ç–æ;
- –ú–µ–Ω–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ –¥–ª—è 3 —Ç–∏–ø–æ–≤ –°–£–ë–î;
- –°–ª–æ–∂–Ω–µ–µ –±—É–¥–µ—Ç –¥–æ–∫—Ä—É—Ç–∏—Ç—å —Å–≤–æ–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Prometheus + Grafana;

### pgAdmin 4

https://www.pgadmin.org/

–ù–µ —Å–æ–≤—Å–µ–º —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞, —Å–∫–æ—Ä–µ–µ –≤–µ–±-GUI –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL (—Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤, –º–∏–≥—Ä–∞—Ü–∏–∏, –±—ç–∫–∞–ø—ã, Query Tool), –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å –±–∞–∑–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é —Å–µ—Ä–≤–µ—Ä–∞.
–û–Ω –ø–æ–¥—Ö–æ–¥–∏—Ç —Å–∫–æ—Ä–µ–µ –∫–∞–∫ —É–¥–æ–±–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞ –∏ —Ç–æ—á–µ—á–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ¬´–∑–¥–µ—Å—å-–∏-—Å–µ–π—á–∞—Å¬ª, –Ω–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞/–∞–ª–µ—Ä—Ç–∏–Ω–≥–∞.

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

Python (Flask) + psycopg/libpq. –†–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö —Ä–µ–∂–∏–º–∞—Ö - Desktop –ø—Ä–∏–ª–æ–∂—É—Ö–∞ –∏ Server (–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ). –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∏–¥–∂–µ—Ç–æ–≤ –±–µ—Ä—ë—Ç –Ω–∞ –ª–µ—Ç—É –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö pg_stat_* –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π PostgreSQL. –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç - —Ç–æ–ª—å–∫–æ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç.

![PGAdmin 4 Architecture](/images/pg_admin_arch.png)

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

|||
| --- | --- |
| –î–∞—à–±–æ—Ä–¥—ã | ¬´–ñ–∏–≤—ã–µ¬ª –≥—Ä–∞—Ñ–∏–∫–∏: CPU/IO wait (—É—Å–ª–æ–≤–Ω–æ–µ –ø–æ PostgreSQL, –∞ –Ω–µ —Ö–æ—Å—Ç–æ–≤—ã–µ), –∞–∫—Ç–∏–≤–Ω—ã–µ/idle —Å–µ—Å—Å–∏–∏, —á–∏—Å–ª–æ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, tuples in/out, —á–µ–∫–ø–æ–∏–Ω—Ç—ã, WAL-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. –î–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `pg_stat_activity`, `pg_stat_database`, `pg_stat_bgwriter`, `pg_stat_replication` –∏ –¥—Ä. |
| Activity / Locks / Sessions | –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–ª–∞–Ω–æ–≤, –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –æ–∂–∏–¥–∞–Ω–∏–π, –æ—Ç–º–µ–Ω–∞/terminate –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. |
| Query Tool | SQL —Ä–µ–¥–∞–∫—Ç–æ—Ä, EXPLAIN/EXPLAIN ANALYZE, –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤. |
| Maintenance | VACUUM/REINDEX/ANALYZE/CLUSTER, –±—ç–∫–∞–ø—ã/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (–æ–±—ë—Ä—Ç–∫–∏ –Ω–∞–¥ `pg_dump/pg_restore`). |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–£–ë–î | –†–æ–ª–∏/–ø—Ä–∞–≤–∞, —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, –ø–∞—Ä—Ç–∏—Ü–∏–∏, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–≤ —Ç.—á. `pg_stat_statements`). |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–†–æ–ª–∏ –≤ UI | –£—á–µ—Ç–∫–∏ —Å–∞–º–æ–≥–æ pgAdmin, –≥—Ä—É–ø–ø—ã, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π, SSO (LDAP/OAuth) |

#### –ú–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã pgAdmin 4
##### –ü–ª—é—Å—ã
- –†–∞–±–æ—Ç–∞ –±–µ–∑ –∞–≥–µ–Ω—Ç–æ–≤: –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∫ PostgreSQL; –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–æ–ª–µ–π;
- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∞–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏–∏: Query Tool, EXPLAIN, –±—ç–∫–∞–ø—ã, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ —Ä–æ–ª—è–º–∏;
- –ü—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞: –ø–∞–∫–µ—Ç—ã –¥–ª—è Win/macOS/Linux, Docker-–æ–±—Ä–∞–∑, Helm-—á–∞—Ä—Ç; —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∫–∞–∫ Desktop, –∏ –∫–∞–∫ Web.
##### –ú–∏–Ω—É—Å—ã
- –ù–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö —Ö–æ—Å—Ç–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ —Ç.–µ. –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–æ–≤—Å–µ–º –Ω–µ –ø–æ–ª–Ω–∞—è;
- –ù–µ —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞: –Ω–µ—Ç –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫/—Å–µ—Ä–∏–π (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–∫—É—â–µ–µ/–Ω–µ–¥–∞–≤–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –±–µ–∑ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
- –ù–µ—Ç –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞, ¬´–ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–π¬ª –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, —Å–æ–≤–µ—Ç–Ω–∏–∫–æ–≤ –∏ –≥–æ—Ç–æ–≤—ã—Ö SLO/alerts;
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å PMM/Grafana; –Ω–µ–ª—å–∑—è ¬´–¥–æ–∫—Ä—É—Ç–∏—Ç—å¬ª —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã/—Å–≤–æ–∏ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∫ –≤ Prometheus.

–í —Ü–µ–ª–æ–º –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞–ª—ã—Ö/—Å—Ä–µ–¥–Ω–∏—Ö –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–π, –≥–¥–µ –Ω–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥—É, –Ω—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ PMM/Prometheus-—Å—Ç—ç–∫—É –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∂–µ–ª–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∏—Ç—å –∑–æ–æ–ø–∞—Ä–∫.

## –ü–ª–∞—Ç–Ω—ã–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### pganalyze

https://pganalyze.com/

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–ª—É–±–æ–∫—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –°–£–ë–î. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å - –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏, –∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –ª–æ–≥–∏, –Ω–∞—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –¥–∞–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é (VACUUM/ANALYZE).

–ï—Å—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø–æ—Å—Ç–∞–≤–∫–∏:
- SaaS (–æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –≤ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ);
- Enterprise Server (self-hosted) ‚Äî —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å —É —Å–µ–±—è.

–î–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤–æ–π open-source –∞–≥–µ–Ω—Ç (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä—è–¥–æ–º —Å –±–∞–∑–æ–π –∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ pganalyze).

![pganalyze](/images/pganalyze.webp)

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**Collector (open-source –∞–≥–µ–Ω—Ç).** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —Ö–æ—Å—Ç–µ —Å PostgreSQL. –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑:
- —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—å—é—Ö (pg_stat_statements, pg_stat_activity, pg_stat_bgwriter –∏ –¥—Ä.),
- –ª–æ–≥–æ–≤ PostgreSQL (–ø–∞—Ä—Å–∏–Ω–≥ slow queries, –æ—à–∏–±–æ–∫, deadlocks),
- –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

–ü–µ—Ä–µ–¥–∞—ë—Ç –≤—Å—ë —ç—Ç–æ –≤ —Å–µ—Ä–≤–∏—Å pganalyze (—á–µ—Ä–µ–∑ TLS).

**pganalyze Backend (SaaS –∏–ª–∏ self-hosted)**
- –•—Ä–∞–Ω–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏;
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, —Å—Ç—Ä–æ–∏—Ç EXPLAIN-–ø–ª–∞–Ω—ã, –≤—ã—è–≤–ª—è–µ—Ç —É–∑–∫–∏–µ –º–µ—Å—Ç–∞;
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–≤–µ—Ç—ã: –∫–∞–∫–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç, –≥–¥–µ –Ω—É–∂–µ–Ω VACUUM, –≥–¥–µ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏;
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç OpenTelemetry –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å APM/Observability-—Å–∏—Å—Ç–µ–º–∞–º–∏.

**Web UI (Dashboard).** –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä. –ï—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏:
- –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ (CPU/IO/locks/sessions),
- —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º –∏ –∏—Ö –ø–ª–∞–Ω–∞–º,
- Index Advisor, Vacuum Advisor,
- Log Insights (–æ—à–∏–±–∫–∏, deadlocks, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã). –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∞–ª–µ—Ä—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –∫–∞–∫–æ–π-–Ω–∏–±—É–ª—å Slack.

![pganalyze Architecture](/images/pganalyze_arch.png)

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

|                            |                                                                                                      |
| -------------------------- | ---------------------------------------------------------------------------------------------------- |
| –î–∞—à–±–æ—Ä–¥—ã      | –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–∏–ø–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏.        |
| –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏      | –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, EXPLAIN-–ø–ª–∞–Ω—ã, –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å–∞–º—ã—Ö ¬´—Ç—è–∂—ë–ª—ã—Ö¬ª –∏ —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º—ã—Ö SQL.        |
| –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤          | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∏–Ω–¥–µ–∫—Å–æ–≤, –≤–∫–ª—é—á–∞—è –æ—Ü–µ–Ω–∫—É –≤—ã–∏–≥—Ä—ã—à–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.      |
| VACUUM/ANALYZE | –°–æ–≤–µ—Ç—É–µ—Ç, –∫–æ–≥–¥–∞ —Ç–∞–±–ª–∏—Ü—ã —Ä–∞–∑–¥—É–≤–∞—é—Ç—Å—è –∏ –Ω—É–∂–µ–Ω VACUUM, –ª–∏–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–≤–∞–∫—É—É–º-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. |
| –ê–Ω–∞–ª–∏–∑ –ø–æ –ª–æ–≥–∞–º          | –ü–∞—Ä—Å–∏–Ω–≥ –ª–æ–≥–æ–≤ PostgreSQL: –æ—à–∏–±–∫–∏, deadlocks, statement timeouts, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.                  |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏   | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PostgreSQL –∏ —Å–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.                             |
| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã; –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenTelemetry –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.                        |


#### –ú–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã pganalyze
##### –ü–ª—é—Å—ã
- –•–æ—Ä–æ—à–∏–π —Ñ–æ–∫—É—Å –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º, VACUUM-—Å–æ–≤–µ—Ç—ã, —Ä–∞–∑–±–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –ª–æ–≥–æ–≤;
- Collector - open source, –ª–µ–≥–∫–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å;
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ SaaS, —Ç–∞–∫ –∏ self-hosted (–∫–æ–º—É-—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–æ–±–Ω–æ –≤ SaaS);
- –ë–æ–≥–∞—Ç–∞—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç —É –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö Prometheus/Grafana-—Å—Ç—ç–∫–æ–≤.
##### –ú–∏–Ω—É—Å—ã
- –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ PostgreSQL (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Percona PMM, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –µ—â—ë MySQL –∏ MongoDB);
- –ù–µ—Ç —Ç–∞–∫–æ–≥–æ —à–∏—Ä–æ–∫–æ–≥–æ –∫–æ–º—å—é–Ω–∏—Ç–∏, –∫–∞–∫ —É Grafana/Prometheus;
- –ù–µ –ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –†–§ (–≤–∏–¥–∏–º–æ –ø–æ–∫–∞ –Ω–∏–∫–∞–∫);

–í —Ü–µ–ª–æ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏ –±–æ–≥–∞—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å –º–∞—Å—Å–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç —É OpenSource –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.

### Tantor Platform

https://tantorlabs.ru/products/platform

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ PostgreSQL –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è. –¶–µ–ª—å - –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏, –∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º –ø–∞—Ä–∫–æ–º Postgres, —Å–æ–±–∏—Ä–∞—Ç—å –∏ —Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ë–î –∏ —Ö–æ—Å—Ç–æ–≤, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –≤—ã–¥–∞–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏—è. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏-—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å (—Ç–µ–Ω–∞–Ω—Ç—ã/–≤–æ—Ä–∫—Å–ø–µ–π—Å—ã), —Ä–æ–ª–∏ –∏ –≥–∏–±–∫–æ–µ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞.
–ú–æ–¥–µ–ª—å –ø–æ—Å—Ç–∞–≤–∫–∏: self-hosted (on-prem), –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è SaaS. –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –≤ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–º –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–º —Ä–µ–∂–∏–º–µ.

![Tantor](/images/tantor.png)

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ê–≥–µ–Ω—Ç—ã (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö —Å PostgreSQL).** –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ go –ø—Ä–æ—Ü–µ—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ:
- —Å–æ–±–∏—Ä–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏ PostgreSQL –∏–∑ pg_stat_*, pg_stat_statements, —Å–æ–±—ã—Ç–∏–π/–ª–æ–≥–æ–≤ –∏ —Ç.–¥.;
- —Å–Ω–∏–º–∞—é—Ç —Ö–æ—Å—Ç–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (CPU, RAM, –¥–∏—Å–∫–∏, —Å–µ—Ç—å);
- –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (VACUUM/ANALYZE, —Å–∫—Ä–∏–ø—Ç—ã), –ø—Ä–∏–º–µ–Ω—è—é—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏;
- –ø—É–±–ª–∏–∫—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤ —à–∏–Ω—É —Å–æ–æ–±—â–µ–Ω–∏–π.

**–®–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (NATS).** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏:
- topics/streams: metrics (—Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è), commands (—É–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∑–∞–¥–∞–Ω–∏—è), events (—Å–æ–±—ã—Ç–∏—è);
- —Ä–∞–∑–≤—è–∑–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤/–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π, –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.

**Keeper (ingest/–æ—á–µ—Ä–µ–¥–∏ –º–µ—Ç—Ä–∏–∫).**
–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–æ—Ç–æ–∫–∏ –º–µ—Ç—Ä–∏–∫ –∏–∑ NATS, –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Ö –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

**Backend (REST/WebSocket API).**
–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: –∫–∞—Ç–∞–ª–æ–≥ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤, –¥–∞—à–±–æ—Ä–¥—ã, –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞, –∞–ª–µ—Ä—Ç—ã, –∑–∞–¥–∞–Ω–∏—è, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏. –û—Ç–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ UI –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–∞–º–∏ (—á–µ—Ä–µ–∑ NATS).

**PG Configurator (advice engine).**
–°–µ—Ä–≤–∏—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º PostgreSQL, –ø—Ä–æ—Ñ–∏–ª—è–º –Ω–∞–≥—Ä—É–∑–∫–∏, VACUUM/AUTOVACUUM, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –ø–∞–º—è—Ç–∏ –∏ I/O. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–≤–µ—Ç—ã –∏ –≥–æ—Ç–æ–≤—ã–µ –ø–∞—Ç—á–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**OperDB (PostgreSQL, —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ).**
–•—Ä–∞–Ω–∏—Ç: –º–µ—Ç—Ä–∏–∫–∏, —Å–æ–±—ã—Ç–∏—è, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –º–æ–¥–µ–ª–∏ –≤–æ—Ä–∫—Å–ø–µ–π—Å–æ–≤/—Ä–æ–ª–µ–π, –∏—Å—Ç–æ—Ä–∏—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á. –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ PgBouncer.

**Web UI (SPA).**
–ü–∞–Ω–µ–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –ø—Ä–æ—Ñ–∏–ª–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∞–ª–µ—Ä—Ç–æ–≤, –∫–∞—Ç–∞–ª–æ–≥ –ë–î, —Ä–∞–±–æ—Ç–∞ —Å –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞–º–∏/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø—Ä.

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.**
- –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã (Telegram, Mattermost, e-mail): –¥–æ—Å—Ç–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤/—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π;
- Triafly BI: —ç–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏;
- SIEM: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π/–∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –ø–æ Syslog (–≤–Ω–µ—à–Ω–∏–µ SOC/SIEM).

![Tantor Architecture](/images/tantor_arch.png)

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

|                                    |                                                                                                                                                                                   |
| ---------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –î–∞—à–±–æ—Ä–¥—ã –∏ –º–µ—Ç—Ä–∏–∫–∏             | –ì–æ—Ç–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏ –∏ –æ–≥—Ä–æ–º–Ω–∞—è –º–∞—Å—Å–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ PostgreSQL –∏ —Ö–æ—Å—Ç—É: —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, hit-ratio, WAL/—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è, —á–µ–∫–ø–æ–∏–Ω—Ç—ã, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏; CPU/RAM/IO/FS/—Å–µ—Ç—å. –ê–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞–º/–∏–Ω—Å—Ç–∞–Ω—Å–∞–º. |
| –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤        | –í—Å—è –∏—Å—Ç–æ—Ä–∏—è ¬´—Ç—è–∂—ë–ª—ã—Ö¬ª –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–ª–∞–Ω—ã `EXPLAIN/ANALYZE`, –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–∞–º–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. |
| –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (PG Configurator) | –°–æ–≤–µ—Ç—ã –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º Postgres (shared\_buffers/work\_mem/–∞–≤—Ç–æ–≤–∞–∫—É—É–º/IO), –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ VACUUM/ANALYZE –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é. |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π       | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ç—á–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –æ—Ç–∫–∞—Ç/–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–æ–≤, –∞—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π. |
| –û–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è          | –£–¥–∞–ª—ë–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ VACUUM/REINDEX/ANALYZE/—Å–∫—Ä–∏–ø—Ç–æ–≤, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á. |
| –ú—É–ª—å—Ç–∏-—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å             | –¢–µ–Ω–∞–Ω—Ç—ã –∏ –≤–æ—Ä–∫—Å–ø–µ–π—Å—ã: –ª–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –±–∞–∑ –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞; —É–¥–æ–±–Ω–∞—è –¥–µ–ª–µ–≥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥–∞–º. |
| RBAC –∏ –∞—É–¥–∏—Ç                   | –†–æ–ª–∏ (viewer/–∞–¥–º–∏–Ω –≤–æ—Ä–∫—Å–ø–µ–π—Å–∞/–∞–¥–º–∏–Ω —Ç–∏–Ω–∞–Ω—Ç–∞/system-admin), –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞–∂–¥—ã–º. |
| –ê–ª–µ—Ä—Ç—ã –∏ –ø–æ–ª–∏—Ç–∏–∫–∏              | –ü–æ—Ä–æ–≥–∏/—É—Å–ª–æ–≤–∏—è, –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ (silence), –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏/—Ç–µ–Ω–∞–Ω—Ç—É, —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏                     | –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã (Telegram/e-mail), Triafly BI (—ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏), SIEM (syslog). |
| API/–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è              | –ü–æ–ª–Ω—ã–π REST API (Swagger/OpenAPI) –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ self-service —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. |
| HA                             | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–π –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã; —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PostgreSQL-–∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ (Patroni), –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ failover-—Å–æ–±—ã—Ç–∏–π. |
| –ö–ª–∞—Å—Ç–µ—Ä—ã                       | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ Patroni |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å/Compliance        | –ò–∑–æ–ª—è—Ü–∏—è –¥–æ—Å—Ç—É–ø–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–µ–¥ –≤—ã–≥—Ä—É–∑–∫–∞–º–∏), –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π. |
| –ë–µ–∫–∞–ø–∏—Ä–æ–≤–∞–Ω–∏–µ                  | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∫–∞–ø–∏—Ä–æ–≤–∞–Ω–∏—è Backman –∏ RuBackup |


#### –ú–∏–Ω—É—Å—ã –∏ –ø–ª—é—Å—ã Tantor Platform
##### –ü–ª—é—Å—ã
- –ï—Å—Ç—å —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞ üòÉ.
- –ì–ª—É–±–æ–∫–∞—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–Ω–æ –ø–æ–¥ PostgreSQL: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑ –ø–ª–∞–Ω–æ–≤, –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª.
- –ï–¥–∏–Ω—ã–π —Å—Ç–µ–∫: —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ UI –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã; –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö TSDB/Grafana/ClickHouse.
- –ü–æ–ª–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: –ë–î –∏ –û–° —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–æ–≤; –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —à–∏–Ω–∞ NATS –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º.
- –ú—É–ª—å—Ç–∏-—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å –∏ RBAC: —É–¥–æ–±–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ –∫–æ–º–∞–Ω–¥–∞–º/–ø—Ä–æ–µ–∫—Ç–∞–º —Å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º –∞—É–¥–∏—Ç–æ–º.
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã, Triafly BI (–¥–ª—è –¥–æ–ª–≥–æ–π –∏—Å—Ç–æ—Ä–∏–∏/–æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏), SIEM (syslog) ‚Äî –±–µ–∑ ¬´—Å–∞–º–æ–¥–µ–ª–æ–∫¬ª.
- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –†–§, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤;
- –£–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø–ª–∞–Ω–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ Explain –æ—Ç Tensor https://explain.tensor.ru/ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ —á—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ "–ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö" –∑–∞–ø—Ä–æ—Å–∞—Ö/–∏–Ω–¥–µ–∫—Å–∞—Ö
![Tantor 03](/images/tantor_03.jpg)

##### –ú–∏–Ω—É—Å—ã
- –¢–æ–ª—å–∫–æ PostgreSQL: –Ω–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –°–£–ë–î (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç PMM).
- –¢—Ä–µ–±—É–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤: —É—Å—Ç–∞–Ω–æ–≤–∫–∞/–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–∫–∞ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º —É –ø—Ä–æ—Å—Ç—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤ Grafana.
- –ö–∞—Å—Ç–æ–º-–¥–∞—à–±–æ—Ä–¥–æ–≤ –Ω–µ—Ç: –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–∏; –≥–∏–±–∫–æ—Å—Ç—å –Ω–∏–∂–µ, —á–µ–º —É —á–∏—Å—Ç–æ–≥–æ Grafana-—Å—Ç–µ–∫–∞ (–∑–∞—Ç–æ –º–µ–Ω—å—à–µ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).

![Tantor 01](/images/tantor_01.png)

![Tantor 02](/images/tantor_02.png)

–í —Ü–µ–ª–æ–º —ç—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —É—Ä–æ–≤–Ω—è enterprise –¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ PostgreSQL: —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —Å–Ω–∏–∂–∞–µ—Ç TTR –∑–∞ —Å—á—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, —Ö–æ—Ä–æ—à–æ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ª–∞–Ω–¥—à–∞—Ñ—Ç —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —Ä–æ–ª–∏. –ü–æ–∂–∞–ª—É–π –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –≤ –ø–ª–∞–Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö.